var J=Object.defineProperty,Q=Object.defineProperties;var W=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var X=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var z=(C,n,o)=>n in C?J(C,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):C[n]=o,j=(C,n)=>{for(var o in n||(n={}))X.call(n,o)&&z(C,o,n[o]);if(R)for(var o of R(n))Y.call(n,o)&&z(C,o,n[o]);return C},N=(C,n)=>Q(C,W(n));var $=(C,n,o)=>new Promise((a,r)=>{var g=b=>{try{y(o.next(b))}catch(c){r(c)}},k=b=>{try{y(o.throw(b))}catch(c){r(c)}},y=b=>b.done?a(b.value):Promise.resolve(b.value).then(g,k);y((o=o.apply(C,n)).next())});import{_ as F,r as m,h as A,c as f,o as p,b as e,j as _,v as w,l as P,F as I,a as L,n as x,t as V,g as O,w as E,p as H,m as q,d as B,k as D,q as Z,s as T,u as K}from"./index-DY_4vCzK.js";import{a as G,e as ee,u as te,f as le,h as ne,i as se,j as oe,k as ae,l as ue,m as ie,d as de,b as re,n as ve,o as ce,p as pe,c as me,q as ge,r as he,s as fe,g as _e,t as be,v as we,w as ke,x as $e}from"./api-C2xAtNMj.js";const ye={class:"menu-manage"},Me={class:"menu-header"},Ce={class:"menu-add"},Ue={class:"menu-content"},Ve={class:"menu-list"},Be={class:"main-menu"},xe={class:"menu-info"},Se=["onUpdate:modelValue","onBlur"],Ie={class:"menu-order"},Le=["onUpdate:modelValue","onBlur"],Ae={class:"menu-actions"},Fe=["onClick","title"],Te=["onClick"],Pe={class:"sub-menu-header"},He={class:"sub-menu-title"},Re=["onClick"],ze={key:0,class:"sub-menu-list"},je={class:"sub-menu-info"},Ne=["onUpdate:modelValue","onBlur"],Ee={class:"sub-menu-order"},De=["onUpdate:modelValue","onBlur"],Ke={class:"sub-menu-actions"},Oe=["onClick"],qe={key:1,class:"empty-sub-menu"},Ge=["onClick"],Je={__name:"MenuManage",setup(C){const n=m([]),o=m("");A(a);function a(){return $(this,null,function*(){const t=yield G();n.value=t.data.map(l=>N(j({},l),{showSubMenu:!1}))})}function r(){return $(this,null,function*(){if(!o.value.trim())return;const t=n.value.length?Math.max(...n.value.map(l=>l.order||0)):0;yield ee({name:o.value.trim(),order:t+1}),o.value="",a()})}function g(t){return $(this,null,function*(){yield te(t.id,{name:t.name,order:t.order}),a()})}function k(t){return $(this,null,function*(){confirm("确定要删除这个主菜单吗？删除后将同时删除其下的所有子菜单和卡片。")&&(yield le(t),a())})}function y(t){return $(this,null,function*(){var v;const l=n.value.find(h=>h.id===t),u=prompt("请输入子菜单名称：");if(!(u!=null&&u.trim()))return;const S=(v=l.subMenus)!=null&&v.length?Math.max(...l.subMenus.map(h=>h.order||0)):0;yield ne(t,{name:u.trim(),order:S+1}),a()})}function b(t){return $(this,null,function*(){yield se(t.id,{name:t.name,order:t.order}),a()})}function c(t){return $(this,null,function*(){confirm("确定要删除这个子菜单吗？删除后将同时删除其下的所有卡片。")&&(yield oe(t),a())})}function s(t){const l=n.value.find(u=>u.id===t);l&&(l.showSubMenu=!l.showSubMenu)}return(t,l)=>(p(),f("div",ye,[e("div",Me,[l[2]||(l[2]=e("div",{class:"header-content"},[e("h2",{class:"page-title"},"管理主菜单和子菜单")],-1)),e("div",Ce,[_(e("input",{"onUpdate:modelValue":l[0]||(l[0]=u=>o.value=u),placeholder:"请输入主菜单名称",class:"input"},null,512),[[w,o.value]]),e("button",{class:"btn btn-primary",onClick:r},l[1]||(l[1]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 5v14M5 12h14"})],-1),P(" 添加主菜单 ")]))])]),e("div",Ue,[e("div",Ve,[(p(!0),f(I,null,L(n.value,u=>{var S;return p(),f("div",{key:u.id,class:"menu-item"},[e("div",Be,[e("div",xe,[l[4]||(l[4]=e("div",{class:"menu-icon"},[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 3h18v18H3zM9 9h6v6H9z"})])],-1)),_(e("input",{"onUpdate:modelValue":v=>u.name=v,onBlur:v=>g(u),class:"menu-name-input"},null,40,Se),[[w,u.name]]),e("div",Ie,[l[3]||(l[3]=e("span",{class:"order-label"},"排序",-1)),_(e("input",{"onUpdate:modelValue":v=>u.order=v,type:"number",onBlur:v=>g(u),class:"order-input"},null,40,Le),[[w,u.order,void 0,{number:!0}]])])]),e("div",Ae,[e("button",{class:"btn btn-icon expand-btn",onClick:v=>s(u.id),title:u.showSubMenu?"收起子菜单":"展开子菜单"},l[5]||(l[5]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"m6 9 6 6 6-6"})],-1)]),8,Fe),e("button",{class:"btn btn-danger btn-icon",onClick:v=>k(u.id),title:"删除主菜单"},l[6]||(l[6]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),e("path",{d:"M10 11v6M14 11v6"})],-1)]),8,Te)])]),e("div",{class:x(["sub-menu-section",{expanded:u.showSubMenu}])},[e("div",Pe,[e("div",He,[l[7]||(l[7]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M9 11H1l8-8 8 8h-8v8z"})],-1)),P(" 子菜单 ("+V(((S=u.subMenus)==null?void 0:S.length)||0)+") ",1)]),e("button",{class:"btn btn-sm btn-outline",onClick:v=>y(u.id)},l[8]||(l[8]=[e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 5v14M5 12h14"})],-1),P(" 添加子菜单 ")]),8,Re)]),u.subMenus&&u.subMenus.length>0?(p(),f("div",ze,[(p(!0),f(I,null,L(u.subMenus,v=>(p(),f("div",{key:v.id,class:"sub-menu-item"},[e("div",je,[l[9]||(l[9]=e("div",{class:"sub-menu-icon"},[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M4 6h16M4 12h16M4 18h16"})])],-1)),_(e("input",{"onUpdate:modelValue":h=>v.name=h,onBlur:h=>b(v),class:"sub-menu-name-input"},null,40,Ne),[[w,v.name]]),e("div",Ee,[_(e("input",{"onUpdate:modelValue":h=>v.order=h,type:"number",onBlur:h=>b(v),class:"order-input"},null,40,De),[[w,v.order,void 0,{number:!0}]])])]),e("div",Ke,[e("button",{class:"btn btn-danger btn-icon btn-sm",onClick:h=>c(v.id),title:"删除子菜单"},l[10]||(l[10]=[e("svg",{width:"14",height:"14",viewBox:"0 0 22 22",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),e("path",{d:"M10 11v6M14 11v6"})],-1)]),8,Oe)])]))),128))])):(p(),f("div",qe,[l[11]||(l[11]=e("p",null,"暂无子菜单",-1)),e("button",{class:"btn btn-sm btn-outline",onClick:v=>y(u.id)},"添加第一个子菜单",8,Ge)]))],2)])}),128))])])]))}},Qe=F(Je,[["__scopeId","data-v-5964fa59"]]),We={class:"card-manage"},Xe={class:"card-header"},Ye={class:"card-add"},Ze=["value"],et=["value"],tt={class:"card-card"},lt={class:"card-table"},nt=["onUpdate:modelValue","onBlur"],st=["onUpdate:modelValue","onBlur"],ot=["onUpdate:modelValue","onBlur"],at=["onUpdate:modelValue","onBlur"],ut=["onUpdate:modelValue","onBlur"],it=["onClick"],dt={__name:"CardManage",setup(C){const n=m([]),o=m([]),a=m(),r=m(""),g=m(""),k=m(""),y=m(""),b=O(()=>{if(!a.value)return[];const v=n.value.find(h=>h.id===a.value);return(v==null?void 0:v.subMenus)||[]});A(()=>$(null,null,function*(){const v=yield G();n.value=v.data,n.value.length&&(a.value=n.value[0].id,r.value="")})),E(a,()=>{r.value="",t()}),E(r,t);function c(){r.value=""}function s(){t()}function t(){return $(this,null,function*(){if(!a.value)return;const v=yield de(a.value,r.value||null);o.value=v.data})}function l(){return $(this,null,function*(){!g.value||!k.value||(yield ae({menu_id:a.value,sub_menu_id:r.value||null,title:g.value,url:k.value,logo_url:y.value}),g.value="",k.value="",y.value="",t())})}function u(v){return $(this,null,function*(){yield ue(v.id,{menu_id:a.value,sub_menu_id:r.value||null,title:v.title,url:v.url,logo_url:v.logo_url,desc:v.desc,order:v.order}),t()})}function S(v){return $(this,null,function*(){yield ie(v),t()})}return(v,h)=>(p(),f("div",We,[e("div",Xe,[h[7]||(h[7]=e("div",{class:"header-content"},[e("h2",{class:"page-title"},"管理网站导航卡片，支持主菜单和子菜单分类")],-1)),e("div",Ye,[_(e("select",{"onUpdate:modelValue":h[0]||(h[0]=i=>a.value=i),class:"input narrow",onChange:c},[(p(!0),f(I,null,L(n.value,i=>(p(),f("option",{value:i.id,key:i.id},V(i.name),9,Ze))),128))],544),[[H,a.value]]),_(e("select",{"onUpdate:modelValue":h[1]||(h[1]=i=>r.value=i),class:"input narrow",onChange:s},[h[5]||(h[5]=e("option",{value:""},"主菜单",-1)),(p(!0),f(I,null,L(b.value,i=>(p(),f("option",{value:i.id,key:i.id},V(i.name),9,et))),128))],544),[[H,r.value]]),_(e("input",{"onUpdate:modelValue":h[2]||(h[2]=i=>g.value=i),placeholder:"卡片标题",class:"input narrow"},null,512),[[w,g.value]]),_(e("input",{"onUpdate:modelValue":h[3]||(h[3]=i=>k.value=i),placeholder:"卡片链接",class:"input wide"},null,512),[[w,k.value]]),_(e("input",{"onUpdate:modelValue":h[4]||(h[4]=i=>y.value=i),placeholder:"logo链接(可选)",class:"input wide"},null,512),[[w,y.value]]),e("button",{class:"btn",onClick:l},h[6]||(h[6]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M12 5v14M5 12h14"})],-1),P(" 添加卡片 ")]))])]),e("div",tt,[e("table",lt,[h[9]||(h[9]=e("thead",null,[e("tr",null,[e("th",null,"标题"),e("th",null,"网址"),e("th",null,"Logo链接"),e("th",null,"描述"),e("th",null,"排序"),e("th",null,"操作")])],-1)),e("tbody",null,[(p(!0),f(I,null,L(o.value,i=>(p(),f("tr",{key:i.id},[e("td",null,[_(e("input",{"onUpdate:modelValue":M=>i.title=M,onBlur:M=>u(i),class:"table-input"},null,40,nt),[[w,i.title]])]),e("td",null,[_(e("input",{"onUpdate:modelValue":M=>i.url=M,onBlur:M=>u(i),class:"table-input"},null,40,st),[[w,i.url]])]),e("td",null,[_(e("input",{"onUpdate:modelValue":M=>i.logo_url=M,onBlur:M=>u(i),class:"table-input",placeholder:"logo链接(可选)"},null,40,ot),[[w,i.logo_url]])]),e("td",null,[_(e("input",{"onUpdate:modelValue":M=>i.desc=M,onBlur:M=>u(i),class:"table-input",placeholder:"描述（可选）"},null,40,at),[[w,i.desc]])]),e("td",null,[_(e("input",{"onUpdate:modelValue":M=>i.order=M,type:"number",onBlur:M=>u(i),class:"table-input order-input"},null,40,ut),[[w,i.order,void 0,{number:!0}]])]),e("td",null,[e("button",{class:"btn btn-danger btn-icon",onClick:M=>S(i.id),title:"删除"},h[8]||(h[8]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),e("path",{d:"M10 11v6M14 11v6"})],-1)]),8,it)])]))),128))])])])]))}},rt=F(dt,[["__scopeId","data-v-2003d901"]]),vt={class:"ad-manage"},ct={class:"ad-header"},pt={class:"ad-section"},mt={class:"ad-card"},gt={class:"ad-table"},ht=["onUpdate:modelValue","onBlur"],ft=["onUpdate:modelValue","onBlur"],_t=["onClick"],bt={class:"ad-section"},wt={class:"ad-card"},kt={class:"ad-table"},$t=["onUpdate:modelValue","onBlur"],yt=["onUpdate:modelValue","onBlur"],Mt=["onClick"],Ct={__name:"AdManage",setup(C){const n=m([]),o=m([]),a=m(""),r=m(""),g=m("left");A(k);function k(){return $(this,null,function*(){const s=yield re();n.value=s.data.filter(t=>t.position==="left"),o.value=s.data.filter(t=>t.position==="right")})}function y(){return $(this,null,function*(){!a.value||!r.value||(yield ve({position:g.value,img:a.value,url:r.value}),a.value="",r.value="",g.value="left",k())})}function b(s){return $(this,null,function*(){yield ce(s.id,{img:s.img,url:s.url}),k()})}function c(s){return $(this,null,function*(){yield pe(s),k()})}return(s,t)=>(p(),f("div",vt,[e("div",ct,[e("form",{class:"ad-add-row",onSubmit:q(y,["prevent"])},[_(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>a.value=l),placeholder:"广告图片链接",class:"input"},null,512),[[w,a.value]]),_(e("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>r.value=l),placeholder:"广告跳转链接",class:"input"},null,512),[[w,r.value]]),_(e("select",{"onUpdate:modelValue":t[2]||(t[2]=l=>g.value=l),class:"input select-input"},t[3]||(t[3]=[e("option",{value:"left"},"左侧广告",-1),e("option",{value:"right"},"右侧广告",-1)]),512),[[H,g.value]]),t[4]||(t[4]=e("button",{class:"btn",type:"submit"},"添加广告",-1))],32)]),e("div",pt,[t[6]||(t[6]=e("h3",{class:"section-title"},"左侧广告列表",-1)),e("div",mt,[e("table",gt,[t[5]||(t[5]=e("thead",null,[e("tr",null,[e("th",null,"图片"),e("th",null,"跳转链接"),e("th",null,"操作")])],-1)),e("tbody",null,[(p(!0),f(I,null,L(n.value,l=>(p(),f("tr",{key:l.id},[e("td",null,[_(e("input",{"onUpdate:modelValue":u=>l.img=u,onBlur:u=>b(l),class:"input"},null,40,ht),[[w,l.img]])]),e("td",null,[_(e("input",{"onUpdate:modelValue":u=>l.url=u,onBlur:u=>b(l),class:"input"},null,40,ft),[[w,l.url]])]),e("td",null,[e("button",{class:"btn btn-danger",onClick:u=>c(l.id)},"删除广告",8,_t)])]))),128))])])])]),e("div",bt,[t[8]||(t[8]=e("h3",{class:"section-title"},"右侧广告列表",-1)),e("div",wt,[e("table",kt,[t[7]||(t[7]=e("thead",null,[e("tr",null,[e("th",null,"图片"),e("th",null,"跳转链接"),e("th",null,"操作")])],-1)),e("tbody",null,[(p(!0),f(I,null,L(o.value,l=>(p(),f("tr",{key:l.id},[e("td",null,[_(e("input",{"onUpdate:modelValue":u=>l.img=u,onBlur:u=>b(l),class:"input"},null,40,$t),[[w,l.img]])]),e("td",null,[_(e("input",{"onUpdate:modelValue":u=>l.url=u,onBlur:u=>b(l),class:"input"},null,40,yt),[[w,l.url]])]),e("td",null,[e("button",{class:"btn btn-danger",onClick:u=>c(l.id)},"删除广告",8,Mt)])]))),128))])])])])]))}},Ut=F(Ct,[["__scopeId","data-v-780b5e23"]]),Vt={class:"friend-manage"},Bt={class:"friend-add"},xt={class:"friend-card"},St={class:"friend-table"},It=["onUpdate:modelValue","onBlur"],Lt=["onUpdate:modelValue","onBlur"],At=["onUpdate:modelValue","onBlur"],Ft=["onClick"],Tt={__name:"FriendLinkManage",setup(C){const n=m([]),o=m(""),a=m(""),r=m("");A(g);function g(){return $(this,null,function*(){const c=yield me();n.value=c.data})}function k(){return $(this,null,function*(){!o.value||!a.value||(yield ge({title:o.value,url:a.value,logo:r.value}),o.value="",a.value="",r.value="",g())})}function y(c){return $(this,null,function*(){yield he(c.id,{title:c.title,url:c.url,logo:c.logo}),g()})}function b(c){return $(this,null,function*(){yield fe(c),g()})}return(c,s)=>(p(),f("div",Vt,[s[4]||(s[4]=e("div",{class:"friend-header"},null,-1)),e("div",Bt,[_(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>o.value=t),placeholder:"网站名",class:"input"},null,512),[[w,o.value]]),_(e("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>a.value=t),placeholder:"网站链接",class:"input"},null,512),[[w,a.value]]),_(e("input",{"onUpdate:modelValue":s[2]||(s[2]=t=>r.value=t),placeholder:"logo链接(可选)",class:"input"},null,512),[[w,r.value]]),e("button",{class:"btn",onClick:k},"添加友链")]),e("div",xt,[e("table",St,[s[3]||(s[3]=e("thead",null,[e("tr",null,[e("th",null,"网站名"),e("th",null,"链接"),e("th",null,"Logo"),e("th",null,"操作")])],-1)),e("tbody",null,[(p(!0),f(I,null,L(n.value,t=>(p(),f("tr",{key:t.id},[e("td",null,[_(e("input",{"onUpdate:modelValue":l=>t.title=l,onBlur:l=>y(t),class:"input"},null,40,It),[[w,t.title]])]),e("td",null,[_(e("input",{"onUpdate:modelValue":l=>t.url=l,onBlur:l=>y(t),class:"input"},null,40,Lt),[[w,t.url]])]),e("td",null,[_(e("input",{"onUpdate:modelValue":l=>t.logo=l,onBlur:l=>y(t),class:"input",placeholder:"logo链接(可选)"},null,40,At),[[w,t.logo]])]),e("td",null,[e("button",{class:"btn btn-danger",onClick:l=>b(t.id)},"删除",8,Ft)])]))),128))])])])]))}},Pt=F(Tt,[["__scopeId","data-v-f280329a"]]),Ht={class:"settings-manage"},Rt={class:"settings-form"},zt={class:"form-group"},jt={class:"preview-section"},Nt={class:"preview-container"},Et=["src"],Dt={key:1,class:"preview-error"},Kt={key:2,class:"preview-placeholder"},Ot={class:"button-group"},qt=["disabled"],Gt={__name:"SettingsManage",setup(C){const n=m(""),o=m(!1),a=m(""),r=m(""),g=m(!1);A(()=>$(null,null,function*(){try{const c=yield _e();n.value=c.data.url||""}catch(c){console.error("获取背景图片设置失败:",c)}}));function k(c){try{return new URL(c),!0}catch(s){return!1}}function y(){return $(this,null,function*(){var c,s;if(!n.value.trim()){a.value="请输入图片URL",r.value="error";return}if(!k(n.value)){a.value="请输入有效的URL地址",r.value="error";return}o.value=!0;try{const t=yield be(n.value);a.value="背景图片URL已成功更新！",r.value="success",g.value=!1}catch(t){console.error("更新背景图片失败:",t),a.value="更新失败："+(((s=(c=t.response)==null?void 0:c.data)==null?void 0:s.message)||t.message),r.value="error"}finally{o.value=!1}})}function b(){A(),a.value="",g.value=!1}return(c,s)=>(p(),f("div",Ht,[s[5]||(s[5]=e("div",{class:"manage-header"},[e("h3",null,"背景图片设置")],-1)),e("div",Rt,[e("div",zt,[s[2]||(s[2]=e("label",null,"背景图片URL",-1)),_(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>n.value=t),type:"text",placeholder:"输入图片URL (如: https://example.com/image.png)",class:"input"},null,512),[[w,n.value]]),s[3]||(s[3]=e("p",{class:"help-text"},"请输入完整的图片URL地址",-1))]),e("div",jt,[s[4]||(s[4]=e("label",null,"图片预览",-1)),e("div",Nt,[n.value&&k(n.value)?(p(),f("img",{key:0,src:n.value,alt:"背景图片预览",class:"preview-image",onError:s[1]||(s[1]=t=>g.value=!0)},null,40,Et)):g.value?(p(),f("div",Dt," 图片加载失败，请检查URL是否正确 ")):(p(),f("div",Kt," 输入图片URL后显示预览 "))])]),e("div",Ot,[e("button",{onClick:y,disabled:o.value||!n.value.trim(),class:"btn btn-primary"},V(o.value?"保存中...":"保存设置"),9,qt),e("button",{onClick:b,class:"btn btn-secondary"}," 重置 ")]),a.value?(p(),f("p",{key:0,class:x(["message",r.value])},V(a.value),3)):B("",!0)])]))}},Jt=F(Gt,[["__scopeId","data-v-c98bbc85"]]),Qt={class:"user-manage"},Wt={class:"user-card"},Xt={class:"password-section"},Yt={class:"password-form"},Zt={class:"form-group"},el={class:"form-group"},tl={class:"form-group"},ll={class:"form-actions"},nl=["disabled"],sl={__name:"UserManage",setup(C){const n=m(""),o=m(""),a=m(""),r=m(!1),g=m(""),k=m("success"),y=m({});A(()=>$(null,null,function*(){try{const s=yield we();y.value=s.data}catch(s){console.error("获取用户信息失败:",s)}}));function b(){return $(this,null,function*(){var s,t;if(!n.value||!o.value||!a.value){c("请填写所有密码字段","error");return}if(o.value!==a.value){c("两次输入的新密码不一致","error");return}if(o.value.length<6){c("新密码长度至少6位","error");return}r.value=!0,g.value="";try{yield ke(n.value,o.value),c("密码修改成功","success"),n.value="",o.value="",a.value=""}catch(l){c(((t=(s=l.response)==null?void 0:s.data)==null?void 0:t.message)||"密码修改失败","error")}finally{r.value=!1}})}function c(s,t){g.value=s,k.value=t,s==="密码修改成功"&&t==="success"?setTimeout(()=>{g.value="2秒后自动退出登录,请使用新密码重新登录...",setTimeout(()=>{localStorage.removeItem("token"),window.location.reload()},2e3)},500):setTimeout(()=>{g.value=""},3e3)}return(s,t)=>(p(),f("div",Qt,[t[7]||(t[7]=e("div",{class:"user-header"},null,-1)),e("div",Wt,[e("div",Xt,[t[6]||(t[6]=e("h3",{class:"section-title"},"修改密码",-1)),e("div",Yt,[e("div",Zt,[t[3]||(t[3]=e("label",null,"当前密码：",-1)),_(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>n.value=l),type:"password",placeholder:"请输入当前密码",class:"input"},null,512),[[w,n.value]])]),e("div",el,[t[4]||(t[4]=e("label",null,"新密码：",-1)),_(e("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>o.value=l),type:"password",placeholder:"请输入新密码",class:"input"},null,512),[[w,o.value]])]),e("div",tl,[t[5]||(t[5]=e("label",null,"确认新密码：",-1)),_(e("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>a.value=l),type:"password",placeholder:"请再次输入新密码",class:"input"},null,512),[[w,a.value]])]),e("div",ll,[e("button",{onClick:b,class:"btn",disabled:r.value},V(r.value?"修改中...":"修改密码"),9,nl)]),g.value?(p(),f("p",{key:0,class:x(["message",k.value])},V(g.value),3)):B("",!0)])])])]))}},ol=F(sl,[["__scopeId","data-v-85ce40f4"]]),al={key:0,class:"login-container"},ul={class:"login-card"},il={class:"login-form"},dl={class:"password-input-wrapper"},rl=["type"],vl={key:0,width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"#2566d8","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},cl={key:1,width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"#2566d8","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},pl={class:"login-buttons"},ml=["disabled"],gl={key:0,class:"login-error"},hl={key:1,class:"admin-layout"},fl={class:"menu-list"},_l={class:"admin-main"},bl={class:"admin-header"},wl={class:"header-title"},kl={class:"admin-content"},$l={key:0,class:"welcome-page"},yl={class:"welcome-cards"},Ml={class:"welcome-card"},Cl={class:"welcome-value"},Ul={class:"welcome-card"},Vl={class:"welcome-value"},Bl={__name:"Admin",setup(C){const n=m("welcome"),o=m(""),a=m(""),r=m(!1),g=m(""),k=m(""),y=m(!1),b=m(""),c=m(!1),s=m(!1),t=O(()=>{switch(n.value){case"menu":return"栏目管理";case"card":return"卡片管理";case"ad":return"广告管理";case"friend":return"友链管理";case"settings":return"系统设置";case"user":return"用户管理";default:return""}});A(()=>{const M=localStorage.getItem("token");r.value=!!M,r.value&&l()});function l(){return $(this,null,function*(){try{const M=yield fetch("/api/users/me",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(M.ok){const d=yield M.json();o.value=d.last_login_time||"",a.value=d.last_login_ip||""}}catch(M){console.error("获取用户信息失败:",M)}})}function u(){return $(this,null,function*(){var M,d;if(!g.value||!k.value){b.value="请输入用户名和密码";return}y.value=!0,b.value="";try{const U=yield $e(g.value,k.value);U.data.token&&(localStorage.setItem("token",U.data.token),r.value=!0,o.value=U.data.lastLoginTime||"",a.value=U.data.lastLoginIp||"")}catch(U){b.value=((d=(M=U.response)==null?void 0:M.data)==null?void 0:d.message)||"登录失败，请检查用户名和密码"}finally{y.value=!1}})}function S(){localStorage.removeItem("token"),r.value=!1,g.value="",k.value="",b.value=""}function v(){window.open("/","_blank")}function h(){s.value=!s.value}function i(){s.value=!1}return(M,d)=>r.value?(p(),f("div",hl,[e("aside",{class:x(["admin-sider",{open:s.value}]),onClick:q(i,["self"])},[e("div",{class:"logo clickable",onClick:d[3]||(d[3]=U=>{n.value="welcome",i()})},"Admin"),e("ul",fl,[e("li",{class:x({active:n.value==="menu"}),onClick:d[4]||(d[4]=U=>{n.value="menu",i()})},"栏目管理",2),e("li",{class:x({active:n.value==="card"}),onClick:d[5]||(d[5]=U=>{n.value="card",i()})},"卡片管理",2),e("li",{class:x({active:n.value==="ad"}),onClick:d[6]||(d[6]=U=>{n.value="ad",i()})},"广告管理",2),e("li",{class:x({active:n.value==="friend"}),onClick:d[7]||(d[7]=U=>{n.value="friend",i()})},"友链管理",2),e("li",{class:x({active:n.value==="settings"}),onClick:d[8]||(d[8]=U=>{n.value="settings",i()})},"系统设置",2),e("li",{class:x({active:n.value==="user"}),onClick:d[9]||(d[9]=U=>{n.value="user",i()})},"用户管理",2)])],2),e("main",_l,[e("div",bl,[e("button",{class:"menu-toggle",onClick:h}," ☰ "),e("div",wl,V(t.value),1),e("div",{class:"header-actions"},[e("span",{class:"home-icon",onClick:v,title:"进入主页"},d[14]||(d[14]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none"},[e("path",{d:"M3 10.5L12 4l9 6.5V20a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1v-4h-4v4a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V10.5z",stroke:"#2566d8","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])),e("button",{class:"btn logout-btn",onClick:S},"退出登录")])]),e("div",kl,[n.value==="welcome"?(p(),f("div",$l,[d[17]||(d[17]=e("h2",{class:"welcome-title"},"欢迎您进入 Nav-Item 后台管理系统",-1)),e("div",yl,[e("div",Ml,[d[15]||(d[15]=K('<div class="welcome-icon time-icon" data-v-5bf7d9f5><svg width="32" height="32" viewBox="0 0 24 24" fill="none" data-v-5bf7d9f5><circle cx="12" cy="12" r="10" stroke="#1abc9c" stroke-width="2" data-v-5bf7d9f5></circle><path d="M12 6v6l4 2" stroke="#1abc9c" stroke-width="2" stroke-linecap="round" data-v-5bf7d9f5></path></svg></div><div class="welcome-label" data-v-5bf7d9f5>上次登录时间</div>',2)),e("div",Cl,V(o.value||"--"),1)]),e("div",Ul,[d[16]||(d[16]=K('<div class="welcome-icon ip-icon" data-v-5bf7d9f5><svg width="32" height="32" viewBox="0 0 24 24" fill="none" data-v-5bf7d9f5><circle cx="12" cy="12" r="10" stroke="#1abc9c" stroke-width="2" data-v-5bf7d9f5></circle><path d="M12 8a4 4 0 1 1 0 8 4 4 0 0 1 0-8z" stroke="#1abc9c" stroke-width="2" data-v-5bf7d9f5></path><circle cx="12" cy="12" r="2" fill="#1abc9c" data-v-5bf7d9f5></circle></svg></div><div class="welcome-label" data-v-5bf7d9f5>上次登录IP</div>',2)),e("div",Vl,V(a.value||"--"),1)])])])):B("",!0),n.value==="menu"?(p(),T(Qe,{key:1})):B("",!0),n.value==="card"?(p(),T(rt,{key:2})):B("",!0),n.value==="ad"?(p(),T(Ut,{key:3})):B("",!0),n.value==="friend"?(p(),T(Pt,{key:4})):B("",!0),n.value==="settings"?(p(),T(Jt,{key:5})):B("",!0),n.value==="user"?(p(),T(ol,{key:6})):B("",!0)]),d[18]||(d[18]=e("footer",{class:"admin-footer"},[e("p",{class:"admin-copyright"},[P("Copyright © 2025 Nav-Item | "),e("a",{href:"https://github.com/eooce/Nav-Item",target:"_blank",class:"footer-link"},"Powered by eooce")])],-1))])])):(p(),f("div",al,[e("div",ul,[d[13]||(d[13]=e("h2",{class:"login-title"},"后台管理登录",-1)),e("div",il,[_(e("input",{"onUpdate:modelValue":d[0]||(d[0]=U=>g.value=U),type:"text",placeholder:"用户名",class:"login-input",onKeyup:D(u,["enter"])},null,544),[[w,g.value]]),e("div",dl,[_(e("input",{"onUpdate:modelValue":d[1]||(d[1]=U=>k.value=U),type:c.value?"text":"password",placeholder:"密码",class:"login-input password-input",onKeyup:D(u,["enter"])},null,40,rl),[[Z,k.value]]),e("span",{class:"toggle-password",onClick:d[2]||(d[2]=U=>c.value=!c.value)},[c.value?(p(),f("svg",vl,d[10]||(d[10]=[e("path",{d:"M1 12s4-7 11-7 11 7 11 7-4 7-11 7S1 12 1 12z"},null,-1),e("circle",{cx:"12",cy:"12",r:"3"},null,-1)]))):(p(),f("svg",cl,d[11]||(d[11]=[e("path",{d:"M17.94 17.94A10.94 10.94 0 0 1 12 19c-7 0-11-7-11-7a21.77 21.77 0 0 1 5.06-6.06"},null,-1),e("path",{d:"M1 1l22 22"},null,-1),e("path",{d:"M9.53 9.53A3 3 0 0 0 12 15a3 3 0 0 0 2.47-5.47"},null,-1)])))])]),e("div",pl,[e("button",{onClick:v,class:"back-btn"},d[12]||(d[12]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M19 12H5M12 19l-7-7 7-7"})],-1),P(" 返回首页 ")])),e("button",{onClick:u,class:"login-btn",disabled:y.value},V(y.value?"登录中...":"登录"),9,ml)]),b.value?(p(),f("p",gl,V(b.value),1)):B("",!0)])])]))}},Ll=F(Bl,[["__scopeId","data-v-5bf7d9f5"]]);export{Ll as default};
